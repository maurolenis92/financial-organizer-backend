{
  "info": {
    "_postman_id": "finansmart-api-collection-2025",
    "name": "FinanSmart API Collection",
    "description": "ColecciÃ³n completa de la API de FinanSmart - Sistema de gestiÃ³n financiera personal con autenticaciÃ³n",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "finansmart"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{authToken}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "ðŸ  Health Check",
      "item": [
        {
          "name": "Root Endpoint",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/",
              "host": ["{{baseUrl}}"],
              "path": [""]
            }
          },
          "response": []
        },
        {
          "name": "Health Check",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/health",
              "host": ["{{baseUrl}}"],
              "path": ["health"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "ðŸ‘¤ Users",
      "item": [
        {
          "name": "Create User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('userId', response.id);",
                  "    pm.test('User created successfully', function () {",
                  "        pm.expect(response.email).to.not.be.undefined;",
                  "        pm.expect(response.id).to.not.be.undefined;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"usuario@ejemplo.com\",\n  \"name\": \"Usuario de Ejemplo\",\n  \"cognitoId\": \"us-east-1_xxxxxxxxx\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"]
            }
          },
          "response": []
        },
        {
          "name": "Get All Users",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"]
            }
          },
          "response": []
        },
        {
          "name": "Get User by ID (from token)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/user",
              "host": ["{{baseUrl}}"],
              "path": ["api", "user"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "ðŸ’° Budgets",
      "item": [
        {
          "name": "Create Budget",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// Set userId in query params if not set as environment variable",
                  "if (!pm.environment.get('userId')) {",
                  "    pm.environment.set('userId', '550e8400-e29b-41d4-a716-446655440000');",
                  "}"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('budgetId', response.id);",
                  "    pm.test('Budget created successfully', function () {",
                  "        pm.expect(response.id).to.not.be.undefined;",
                  "        pm.expect(response.userId).to.not.be.undefined;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"startDate\": \"2025-01-01T00:00:00.000Z\",\n  \"endDate\": \"2025-12-31T23:59:59.999Z\",\n  \"name\": \"Presupuesto 2025\",\n  \"currency\": \"COP\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/budgets",
              "host": ["{{baseUrl}}"],
              "path": ["api", "budgets"]
            }
          },
          "response": []
        },
        {
          "name": "Get All Budgets (from token)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/budgets",
              "host": ["{{baseUrl}}"],
              "path": ["api", "budgets"]
            }
          },
          "response": []
        },
        {
          "name": "Get Budget by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/budgets/{{budgetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "budgets", "{{budgetId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Budget (Full)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"startDate\": \"2025-01-01T00:00:00.000Z\",\n  \"endDate\": \"2025-12-31T23:59:59.999Z\",\n  \"currency\": \"USD\",\n  \"incomes\": [\n    {\n      \"id\": \"{{incomeId}}\",\n      \"concept\": \"Salario\",\n      \"amount\": 5000000\n    }\n  ],\n  \"expenses\": [\n    {\n      \"id\": \"{{expenseId}}\",\n      \"concept\": \"Renta\",\n      \"amount\": 1500000,\n      \"categoryId\": \"{{categoryId}}\",\n      \"status\": \"PAID\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/budgets/{{budgetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "budgets", "{{budgetId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Budget",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/budgets/{{budgetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "budgets", "{{budgetId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "ðŸ“Š Categories",
      "item": [
        {
          "name": "Create Category",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('categoryId', response.id);",
                  "    pm.test('Category created successfully', function () {",
                  "        pm.expect(response.id).to.not.be.undefined;",
                  "        pm.expect(response.name).to.not.be.undefined;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"name\": \"AlimentaciÃ³n\",\n  \"color\": \"#FF5733\",\n  \"icon\": \"food\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/category",
              "host": ["{{baseUrl}}"],
              "path": ["api", "category"]
            }
          },
          "response": []
        },
        {
          "name": "Get Categories by User",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/category/user/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "category", "user", "{{userId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Category",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Comida y Bebidas\",\n  \"color\": \"#33FF57\",\n  \"icon\": \"restaurant\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/category/{{categoryId}}/user/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "category", "{{categoryId}}", "user", "{{userId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Category",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/category/{{categoryId}}/user/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "category", "{{categoryId}}", "user", "{{userId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "ðŸ’µ Incomes",
      "item": [
        {
          "name": "Create Income",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('incomeId', response.id);",
                  "    pm.test('Income created successfully', function () {",
                  "        pm.expect(response.id).to.not.be.undefined;",
                  "        pm.expect(response.amount).to.not.be.undefined;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"budgetId\": \"{{budgetId}}\",\n  \"concept\": \"Salario Mensual\",\n  \"amount\": 3500000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/incomes",
              "host": ["{{baseUrl}}"],
              "path": ["api", "incomes"]
            }
          },
          "response": []
        },
        {
          "name": "Get Incomes by Budget",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/incomes/budget/{{budgetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "incomes", "budget", "{{budgetId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Income",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"concept\": \"Salario Actualizado\",\n  \"amount\": 4000000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/incomes/{{incomeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "incomes", "{{incomeId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Income",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/incomes/{{incomeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "incomes", "{{incomeId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "ðŸ’¸ Expenses",
      "item": [
        {
          "name": "Create Expense",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('expenseId', response.id);",
                  "    pm.test('Expense created successfully', function () {",
                  "        pm.expect(response.id).to.not.be.undefined;",
                  "        pm.expect(response.amount).to.not.be.undefined;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"budgetId\": \"{{budgetId}}\",\n  \"categoryId\": \"{{categoryId}}\",\n  \"concept\": \"Compras del supermercado\",\n  \"amount\": 150000,\n  \"status\": \"PENDING\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/expenses",
              "host": ["{{baseUrl}}"],
              "path": ["api", "expenses"]
            }
          },
          "response": []
        },
        {
          "name": "Get Expenses by Budget",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/expenses/budget/{{budgetId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "expenses", "budget", "{{budgetId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Update Expense",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"categoryId\": \"{{categoryId}}\",\n  \"concept\": \"Compras supermercado actualizado\",\n  \"amount\": 200000,\n  \"status\": \"PAID\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/expenses/{{expenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "expenses", "{{expenseId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Expense",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/expenses/{{expenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "expenses", "{{expenseId}}"]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Auto-set base URL if not defined",
          "if (!pm.environment.get('baseUrl')) {",
          "    pm.environment.set('baseUrl', 'http://localhost:3000');",
          "}",
          "",
          "// Generate sample UUIDs if not set",
          "if (!pm.environment.get('sampleUserId')) {",
          "    pm.environment.set('sampleUserId', '550e8400-e29b-41d4-a716-446655440000');",
          "}",
          "",
          "if (!pm.environment.get('sampleBudgetId')) {",
          "    pm.environment.set('sampleBudgetId', '550e8400-e29b-41d4-a716-446655440001');",
          "}",
          "",
          "if (!pm.environment.get('sampleCategoryId')) {",
          "    pm.environment.set('sampleCategoryId', '550e8400-e29b-41d4-a716-446655440002');",
          "}",
          "",
          "// Log auth token status",
          "const token = pm.environment.get('authToken');",
          "if (!token || token === '') {",
          "    console.warn('âš ï¸ authToken no estÃ¡ configurado. Algunos endpoints pueden fallar.');",
          "} else {",
          "    console.log('âœ… authToken configurado correctamente');",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Global test for response time",
          "pm.test('Response time is less than 2000ms', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(2000);",
          "});",
          "",
          "// Global test for content type on successful responses",
          "if (pm.response.code >= 200 && pm.response.code < 300) {",
          "    pm.test('Content-Type is application/json', function () {",
          "        pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
          "    });",
          "}",
          "",
          "// Check for auth errors",
          "if (pm.response.code === 401) {",
          "    console.error('âŒ Error de autenticaciÃ³n. Verifica que authToken estÃ© configurado correctamente.');",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "550e8400-e29b-41d4-a716-446655440000",
      "type": "string"
    },
    {
      "key": "budgetId",
      "value": "550e8400-e29b-41d4-a716-446655440001",
      "type": "string"
    },
    {
      "key": "categoryId",
      "value": "550e8400-e29b-41d4-a716-446655440002",
      "type": "string"
    },
    {
      "key": "incomeId",
      "value": "",
      "type": "string"
    },
    {
      "key": "expenseId",
      "value": "",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string",
      "description": "JWT Token de AWS Cognito - ConfigÃºralo con tu token de autenticaciÃ³n"
    }
  ]
}
